#!/usr/bin/env python3

import os
import sys
import subprocess
import time

def run_exploit(script_name):
    """Run an individual exploit script"""
    print(f"\n{'='*60}")
    print(f"Running: {script_name}")
    print(f"{'='*60}")
    
    try:
        result = subprocess.run([sys.executable, script_name], 
                              capture_output=True, text=True, timeout=30)
        
        if result.stdout:
            print(result.stdout)
        if result.stderr:
            print(f"Errors: {result.stderr}")
            
        return result.returncode == 0
        
    except subprocess.TimeoutExpired:
        print(f"[-] {script_name} timed out")
        return False
    except Exception as e:
        print(f"[-] Error running {script_name}: {e}")
        return False

def main():
    print("TenantGuard Security Testing Suite")
    print("Author: Selemon Hailu")
    print("="*60)
    
    # List of exploit scripts to run
    exploits = [
        "plaintext_passwords.py",
        "bola_exploit.py", 
        "file_upload_exploit.py",
        "payment_exploit.py",
        "directory_traversal.py",
        "admin_escalation.py",
        "info_disclosure.py",
        "tenant_bypass.py"
    ]
    
    results = {}
    
    for exploit in exploits:
        if os.path.exists(exploit):
            success = run_exploit(exploit)
            results[exploit] = success
            time.sleep(2)  # Brief pause between tests
        else:
            print(f"[-] Script not found: {exploit}")
            results[exploit] = False
    
    # Summary
    print(f"\n{'='*60}")
    print("EXPLOIT SUMMARY")
    print(f"{'='*60}")
    
    successful = 0
    for script, success in results.items():
        status = "[+] SUCCESS" if success else "[-] FAILED"
        print(f"{status}: {script}")
        if success:
            successful += 1
    
    print(f"\nTotal: {successful}/{len(exploits)} exploits successful")
    
    if successful > 0:
        print("\n[!] SECURITY VULNERABILITIES CONFIRMED")
        print("[!] This system requires immediate security patches")
    else:
        print("\n[+] No exploits successful - system appears secure")

if __name__ == "__main__":
    main()