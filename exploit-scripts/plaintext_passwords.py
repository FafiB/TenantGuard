#!/usr/bin/env python3

import requests
import json

BASE_URL = "http://localhost:5000"

def test_plaintext_passwords():
    register_data = {
        "email": "hacker@test.com",
        "password": "123",
        "fullName": "Hacker Test",
        "tenantName": "HackerOrg"
    }
    
    response = requests.post(f"{BASE_URL}/api/auth/register", json=register_data)
    if response.status_code == 201:
        token = response.json()["token"]
        
        login_data = {
            "email": "hacker@test.com", 
            "password": "123"
        }
        
        login_response = requests.post(f"{BASE_URL}/api/auth/login", json=login_data)
        if login_response.status_code == 200:
            print("[+] Login successful - passwords stored in plaintext!")
            return True
    
    print("[-] Exploit failed")
    return False

if __name__ == "__main__":
    test_plaintext_passwords()